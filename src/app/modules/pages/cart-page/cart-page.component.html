<div class="w-full">
  <ng-container *ngIf="!browserDetectorService.isMobile(); else mobileCart">
    <ng-container *ngIf="cart.items.length; else emptyCart">
      <div class="flex flex-col mx-auto w-11/12 bg-white">
        <div class="flex flex-row items-center h-14 border-b">
          <div class="w-1/12 px-2"></div>
          <div class="w-1/3">Product</div>
          <div class="w-1/6">Price</div>
          <div class="w-1/6">
            <span class="">Quantity</span>
          </div>
          <div class="w-1/6">Total</div>
          <div class="flex-1 flex justify-center px-2">
            <button
              (click)="onClearCart()"
              mat-raised-button
              color="warn"
              class=""
            >
              Clear Cart
            </button>
          </div>
        </div>
        <div
          class="flex flex-row items-center min-h-16 border-b text-sm md:text-base"
          *ngFor="let cartItem of cart.items"
        >
          <div class="w-1/12 h-full px-2">
            <img
              [src]="cartItem.image"
              alt="product"
              class="max-w-full max-h-full"
            />
          </div>
          <div class="w-1/3">
            <p class="truncate max-w-xs block hover:overflow-visible">
              {{ cartItem.productName }}
            </p>
            <p *ngIf="cartItem.variant">
              <span
                *ngFor="
                  let attribute of cartItem.variant.productVariantAttributes;
                  index as i
                "
                >{{ attribute.attribute.name
                }}{{
                  cartItem.variant.productVariantAttributes.length > 0 &&
                  cartItem.variant.productVariantAttributes.length - 1 > i
                    ? " - "
                    : ""
                }}</span
              >
            </p>
          </div>
          <div class="w-1/6">{{ cartItem.price | currency }}</div>
          <div class="w-1/6">
            <div class="flex flex-row items-center">
              <button (click)="onRemoveQuantity(cartItem)" mat-icon-button>
                <mat-icon>remove</mat-icon>
              </button>
              <span class="">
                {{ cartItem.quantity }}
              </span>
              <button (click)="onAddQuantity(cartItem)" mat-icon-button>
                <mat-icon>add</mat-icon>
              </button>
            </div>
          </div>
          <div class="w-1/6">
            {{ cartItem.price * cartItem.quantity | currency }}
          </div>
          <div class="flex-1 flex justify-center px-2">
            <button
              (click)="onRemoveFromCart(cartItem)"
              mat-mini-fab
              color="warn"
              class="float-right"
            >
              <mat-icon>close</mat-icon>
            </button>
          </div>
        </div>
        <div class="flex flex-row items-center">
          <div class="w-1/12 px-2">
            <button
              mat-raised-button
              routerLink="/home"
              class="!bg-[whitesmoke]"
            >
              Continue Shopping
            </button>
          </div>
          <div class="w-1/3"></div>
          <div class="w-1/6"></div>
          <div class="w-1/6"></div>
          <div class="w-1/6">
            <span class="font-bold py-5 block">
              {{ getTotal(cart.items) | currency }}
            </span>
          </div>
          <div class="flex-1 px-2">
            <button
              mat-raised-button
              color="primary"
              class=""
              routerLink="/checkout"
            >
              Proceed To Checkout
            </button>
          </div>
        </div>
      </div>
    </ng-container>

    <ng-template #emptyCart>
      <p>
        Your cart is empty.
        <button mat-raised-button routerLink="/home">Start shopping</button>
      </p>
    </ng-template>
  </ng-container>
  <ng-template #mobileCart>
    <ng-container *ngIf="cart.items.length; else emptyCart">
      <div class="flex flex-col bg-white w-11/12 mx-auto">
        <div class="flex flex-row items-center border-b">
          <div>Product</div>
          <div>Total</div>
          <div>
            <button
              (click)="onClearCart()"
              mat-raised-button
              color="warn"
              class=""
            >
              Clear Cart
            </button>
          </div>
        </div>
        <div
          class="flex flex-row items-center min-h-20 border-b"
          *ngFor="let cartItem of cart.items"
        >
          <div class="flex flex-row w-3/6 h-full">
            <div class="w-1/2 h-full">
              <img
                [src]="cartItem.image"
                alt="product"
                class="max-w-full max-h-full"
              />
            </div>
            <div class="flex flex-col">
              <div>
                <p class="truncate max-w-xs block hover:overflow-visible">
                  {{ cartItem.productName }}
                </p>
                <p *ngIf="cartItem.variant">
                  <span
                    *ngFor="
                      let attribute of cartItem.variant
                        .productVariantAttributes;
                      index as i
                    "
                    >{{ attribute.attribute.name
                    }}{{
                      cartItem.variant.productVariantAttributes.length > 0 &&
                      cartItem.variant.productVariantAttributes.length - 1 > i
                        ? " - "
                        : ""
                    }}</span
                  >
                </p>
              </div>
              <div class="flex flex-row items-center h-5">
                <button
                  class="flex items-center border border-slate-400 rounded-l-full hover:bg-[#3f51b5] hover:text-white h-full"
                  (click)="onRemoveQuantity(cartItem)"
                >
                  <mat-icon>remove</mat-icon>
                </button>
                <span
                  class="flex items-center text-nowrap border-y border-slate-400 px-2 h-full"
                >
                  {{ cartItem.quantity }}
                </span>
                <button
                  class="flex items-center border border-slate-400 rounded-r-full hover:bg-[#3f51b5] hover:text-white h-full"
                  (click)="onAddQuantity(cartItem)"
                >
                  <mat-icon>add</mat-icon>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </ng-container>
    <ng-template #emptyCart>
      <p>
        Your cart is empty.
        <button mat-raised-button routerLink="/home">Start shopping</button>
      </p>
    </ng-template>
  </ng-template>
</div>
